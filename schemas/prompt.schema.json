{
  "$id": "https://github.com/Davidmctf/agents-promps/tree/main/schemas/prompt.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "example": {
      "properties": {
        "description": {
          "description": "Example description",
          "type": "string"
        },
        "input": {
          "description": "Input values for placeholders",
          "type": "object"
        },
        "name": {
          "description": "Example name",
          "type": "string"
        },
        "output": {
          "description": "Expected output",
          "type": "string"
        }
      },
      "required": [
        "name",
        "input"
      ],
      "type": "object"
    },
    "placeholder": {
      "properties": {
        "default": {
          "description": "Default value if not provided"
        },
        "description": {
          "description": "Description of what the placeholder represents | Core project metadata (for type: project)",
          "type": "string"
        },
        "enum": {
          "description": "Allowed values for this placeholder",
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "maxLength": {
          "description": "Maximum length for string/array",
          "type": "integer"
        },
        "minLength": {
          "description": "Minimum length for string/array",
          "type": "integer"
        },
        "mode": {
          "description": "Whether this placeholder is for input, output, or both",
          "enum": [
            "input",
            "output",
            "both"
          ],
          "type": "string"
        },
        "model": {
          "default": "copilot/claude-sonnet-4.5",
          "description": "Target model for this placeholder",
          "enum": [
            "copilot/claude-sonnet-4.5",
            "copilot/claude-haiku-4.5",
            "copilot/gemini-2.0-flash-001",
            "copilot/gpt-4o"
          ],
          "type": "string"
        },
        "name": {
          "description": "Name of the placeholder variable",
          "pattern": "^[a-zA-Z][a-zA-Z0-9_]*$",
          "type": "string"
        },
        "pattern": {
          "description": "Regex pattern for string validation",
          "type": "string"
        },
        "required": {
          "default": true,
          "description": "Whether this placeholder must be provided",
          "type": "boolean"
        },
        "tools": {
          "description": "Tools that can be used to fill this placeholder",
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "type": {
          "description": "Data type of the placeholder",
          "enum": [
            "string",
            "number",
            "boolean",
            "array",
            "object"
          ],
          "type": "string"
        }
      },
      "required": [
        "name",
        "type",
        "description",
        "model",
        "mode",
        "tools"
      ],
      "type": "object"
    },
    "templateReference": {
      "properties": {
        "condition": {
          "description": "Conditional expression for template inclusion",
          "type": "string"
        },
        "order": {
          "description": "Execution order in composition",
          "minimum": 1,
          "type": "integer"
        },
        "ref": {
          "description": "Reference to template ID",
          "pattern": "^[a-z][a-z0-9-]*(\\.[a-z][a-z0-9-]*)*$",
          "type": "string"
        },
        "required": {
          "default": true,
          "description": "Whether this template is required",
          "type": "boolean"
        }
      },
      "required": [
        "ref",
        "order"
      ],
      "type": "object"
    },
    "workflowStep": {
      "properties": {
        "action": {
          "description": "Description of what this step does",
          "type": "string"
        },
        "condition": {
          "description": "Condition for executing this step",
          "type": "string"
        },
        "optional": {
          "default": false,
          "description": "Whether this step can be skipped",
          "type": "boolean"
        },
        "step": {
          "description": "Step number in workflow",
          "minimum": 1,
          "type": "integer"
        },
        "template": {
          "description": "Template ID to execute",
          "type": "string"
        }
      },
      "required": [
        "step",
        "action",
        "template"
      ],
      "type": "object"
    }
  },
  "description": "Schema for validating prompt templates and compositions in the agnostic-cop system",
  "oneOf": [
    {
      "description": "A reusable prompt template",
      "properties": {
        "category": {
          "description": "Template category",
          "enum": [
            "core",
            "code",
            "documentation",
            "analysis",
            "problem-solving",
            "custom"
          ],
          "type": "string"
        },
        "description": {
          "description": "Template description",
          "type": "string"
        },
        "examples": {
          "description": "Usage examples",
          "items": {
            "$ref": "#/definitions/example"
          },
          "type": "array"
        },
        "id": {
          "description": "Unique template identifier",
          "pattern": "^[a-z][a-z0-9-]*(\\.[a-z][a-z0-9-]*)*$",
          "type": "string"
        },
        "name": {
          "description": "Human-readable template name",
          "type": "string"
        },
        "placeholders": {
          "description": "List of placeholders in the template",
          "items": {
            "$ref": "#/definitions/placeholder"
          },
          "type": "array"
        },
        "relatedTemplates": {
          "description": "Related template IDs",
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "template": {
          "description": "The actual prompt template with {{placeholders}}",
          "type": "string"
        },
        "usageNotes": {
          "description": "Additional usage notes",
          "type": "string"
        },
        "version": {
          "description": "Semantic version",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "type": "string"
        }
      },
      "required": [
        "id",
        "version",
        "category",
        "name",
        "template"
      ],
      "title": "Template",
      "type": "object"
    },
    {
      "description": "A composition of multiple templates",
      "properties": {
        "category": {
          "description": "Composition category",
          "enum": [
            "code-generation",
            "code-review",
            "documentation",
            "problem-solving",
            "custom"
          ],
          "type": "string"
        },
        "description": {
          "description": "Composition description",
          "type": "string"
        },
        "examples": {
          "description": "Usage examples",
          "items": {
            "$ref": "#/definitions/example"
          },
          "type": "array"
        },
        "id": {
          "description": "Unique composition identifier (must start with 'composition.')",
          "pattern": "^composition\\.[a-z][a-z0-9-]*(\\.[a-z][a-z0-9-]*)*$",
          "type": "string"
        },
        "name": {
          "description": "Human-readable composition name",
          "type": "string"
        },
        "targetAgents": {
          "description": "Agents that can use this composition",
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        "templates": {
          "description": "Templates included in this composition",
          "items": {
            "$ref": "#/definitions/templateReference"
          },
          "minItems": 1,
          "type": "array"
        },
        "usageNotes": {
          "description": "Additional usage notes",
          "type": "string"
        },
        "version": {
          "description": "Semantic version",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "type": "string"
        },
        "workflow": {
          "description": "Workflow steps for executing templates",
          "items": {
            "$ref": "#/definitions/workflowStep"
          },
          "type": "array"
        }
      },
      "required": [
        "id",
        "version",
        "name",
        "category",
        "templates"
      ],
      "title": "Composition",
      "type": "object"
    }
  ],
  "title": "Prompt Schema",
  "version": "2.0.0"
}